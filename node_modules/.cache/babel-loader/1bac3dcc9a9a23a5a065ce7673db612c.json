{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\MERN\\\\booking\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\MERN\\\\booking\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"D:\\\\MERN\\\\booking\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"D:\\\\MERN\\\\booking\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\MERN\\\\booking\\\\client\\\\src\\\\components\\\\reserve\\\\Reserve.jsx\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCircleXmark } from '@fortawesome/free-solid-svg-icons';\nimport React from 'react';\nimport './reserve.css';\nimport useFetch from '../../hooks/useFetch';\nimport { useState } from 'react';\nimport { useContext } from 'react';\nimport { SearchContext } from '../../context/SearchContext';\nexport default function Reserve(_ref) {\n  var _this = this;\n\n  var setOpen = _ref.setOpen,\n      hotelId = _ref.hotelId;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedRooms = _useState2[0],\n      setSelectedRooms = _useState2[1];\n\n  var _useFetch = useFetch(\"/hotels/room/\".concat(hotelId)),\n      data = _useFetch.data,\n      loading = _useFetch.loading,\n      error = _useFetch.error;\n\n  var _useContext = useContext(SearchContext),\n      dates = _useContext.dates;\n\n  var getDatesInRange = function getDatesInRange(startDate, endDate) {\n    var start = new Date(startDate);\n    var end = new Date(endDate);\n    var date = new Date(start.getTime());\n    var list = [];\n\n    while (date <= end) {\n      list.push(new Date(date).getTime());\n      date.setDate(date.getDate() + 1);\n    }\n\n    return list;\n  };\n\n  var alldates = getDatesInRange(dates[0].startDate, dates[0].endDate);\n\n  var isAvailable = function isAvailable(roomNumber) {\n    var isFound = roomNumber.unavailableDates.some(function (date) {\n      return alldates.includes(new Date(date).getTime());\n    });\n    return !isFound;\n  };\n\n  var handleSelect = function handleSelect(e) {\n    var checked = e.target.checked;\n    var value = e.target.value;\n    setSelectedRooms(checked ? [].concat(_toConsumableArray(selectedRooms), [value]) : selectedRooms.filter(function (item) {\n      return item !== value;\n    }));\n  };\n\n  var handleClick = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return Promise.all(selectedRooms.map(function (roomId) {\n                var res = axios.put(\"/rooms/availability/\".concat(roomId), {\n                  dates: alldates\n                });\n                return res.data;\n              }));\n\n            case 3:\n              _context.next = 7;\n              break;\n\n            case 5:\n              _context.prev = 5;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 5]]);\n    }));\n\n    return function handleClick() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"reserve\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"rContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faCircleXmark,\n    className: \"rClose\",\n    onClick: function onClick() {\n      return setOpen(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }\n  }, \"Select your rooms: \"), data.map(function (item) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rItem\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rItemInfo\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rTitle\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 25\n      }\n    }, item.title), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rDesc\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 25\n      }\n    }, item.desc), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rMax\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 25\n      }\n    }, \"Max people: \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 59\n      }\n    }, item.maxPeople)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rPrice\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 25\n      }\n    }, item.price)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rSelectRooms\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 21\n      }\n    }, item.roomNumbers.map(function (roomNumber) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"room\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 33\n        }\n      }, roomNumber.number), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        value: roomNumber._id,\n        onChange: handleSelect,\n        disabled: !isAvailable(roomNumber),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 33\n        }\n      }));\n    })));\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleClick,\n    className: \"rButton\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, \"Reserve Now!\")));\n}","map":{"version":3,"names":["FontAwesomeIcon","faCircleXmark","React","useFetch","useState","useContext","SearchContext","Reserve","setOpen","hotelId","selectedRooms","setSelectedRooms","data","loading","error","dates","getDatesInRange","startDate","endDate","start","Date","end","date","getTime","list","push","setDate","getDate","alldates","isAvailable","roomNumber","isFound","unavailableDates","some","includes","handleSelect","e","checked","target","value","filter","item","handleClick","Promise","all","map","roomId","res","axios","put","title","desc","maxPeople","price","roomNumbers","number","_id"],"sources":["D:/MERN/booking/client/src/components/reserve/Reserve.jsx"],"sourcesContent":["import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faCircleXmark } from '@fortawesome/free-solid-svg-icons'\r\nimport React from 'react'\r\nimport './reserve.css'\r\nimport useFetch from '../../hooks/useFetch'\r\nimport { useState } from 'react'\r\nimport { useContext } from 'react'\r\nimport { SearchContext } from '../../context/SearchContext'\r\n\r\nexport default function Reserve({setOpen, hotelId}) {\r\n\r\nconst [selectedRooms, setSelectedRooms] = useState([])\r\nconst {data, loading, error} = useFetch(`/hotels/room/${hotelId}`) \r\nconst {dates} = useContext(SearchContext)\r\n\r\nconst getDatesInRange = (startDate,endDate) => {\r\n    const start = new Date(startDate)\r\n    const end = new Date(endDate)\r\n    const date = new Date(start.getTime())\r\n    \r\n    let list = []\r\n\r\n    while(date <= end){\r\n        list.push(new Date(date).getTime())\r\n        date.setDate(date.getDate() + 1)\r\n    }\r\n\r\n    return list\r\n}\r\n\r\nconst alldates = getDatesInRange(dates[0].startDate,dates[0].endDate)\r\n\r\nconst isAvailable = (roomNumber) => {\r\n    const isFound = roomNumber.unavailableDates.some(date =>\r\n         alldates.includes(new Date(date).getTime())\r\n    )\r\n\r\n    return !isFound\r\n}\r\n\r\nconst handleSelect = (e) => {\r\n    const checked = e.target.checked\r\n    const value = e.target.value \r\n    setSelectedRooms(checked ? [...selectedRooms, value] : selectedRooms.filter((item) => item !== value))\r\n}\r\n\r\nconst handleClick = async() => {\r\n    try{\r\n        await Promise.all(\r\n            selectedRooms.map(roomId => {\r\n                const res = axios.put(`/rooms/availability/${roomId}`, {dates: alldates})\r\n                return res.data\r\n            })\r\n        )\r\n    }catch(err){\r\n        \r\n    }\r\n}\r\n\r\n  return (\r\n    <div className='reserve'>\r\n        <div className=\"rContainer\">\r\n            <FontAwesomeIcon icon={faCircleXmark} className=\"rClose\" onClick={() => setOpen(false)}/>\r\n            <span>Select your rooms: </span>\r\n            {data.map(item=>(\r\n                <div className=\"rItem\">\r\n                    <div className=\"rItemInfo\">\r\n                        <div className=\"rTitle\">{item.title}</div>\r\n                        <div className=\"rDesc\">{item.desc}</div>\r\n                        <div className=\"rMax\">Max people: <b>{item.maxPeople}</b></div>\r\n                        <div className=\"rPrice\">{item.price}</div>\r\n                    </div>\r\n                    <div className=\"rSelectRooms\">\r\n                        {item.roomNumbers.map(roomNumber => (\r\n                            <div className=\"room\">\r\n                                <label>{roomNumber.number}</label>\r\n                                <input \r\n                                type=\"checkbox\" \r\n                                value={roomNumber._id} \r\n                                onChange={handleSelect}\r\n                                disabled={!isAvailable(roomNumber)}\r\n                                />\r\n                            </div>       \r\n                        ))}\r\n                    </div>\r\n                      \r\n                </div>\r\n            ))}\r\n            <button onClick={handleClick} className=\"rButton\">Reserve Now!</button>\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}